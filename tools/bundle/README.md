# Story Bundles

This directory contains bundled directories generated by the `bundle.py` script for various story writing contexts.

## Current Bundles

- `chapter5_context/` - Context for Chapter 5 writing (characters: Brenden, Mireth, all Lowfields + writing guidelines)
- `chapter5_context_final/` - Final Chapter 5 context with simplified character structure
- `all_assets/` - Complete flattened bundle of all story assets (chapters, characters, guidelines, lore)

## Usage

Bundles are automatically created in this directory when using the bundle script:

```bash
# Get specific items with flexible configuration
python3 tools/bundle/bundle.py --story eol-saga --book book1 --subjects "chapters:000..004,characters:brenden"

# Get everything flattened
python3 tools/bundle/bundle.py --story eol-saga --book book1 --subjects "*" --flat

# Get all characters and places
python3 tools/bundle/bundle.py --story eol-saga --book book1 --subjects "characters:*,places:*"

# Get specific character states
python3 tools/bundle/bundle.py --story eol-saga --book book1 --subjects "characters:brenden/farmboy,mireth/60s"

# Specify custom output directory
python3 tools/bundle/bundle.py --story eol-saga --book book1 --subjects "characters:*/*" --output tools/bundle/bundles/all_characters
```

## Flexible Subject Configuration

The `--subjects` parameter accepts flexible subject:item configurations:

### Format
- `subject:item1,item2,item3` - Multiple items for a subject
- `subject:*` - All items for a subject
- `*` - Everything (all subjects and all items)
- `subject1:item1,subject2:item2` - Multiple subjects with specific items

### Examples
```bash
# Get chapters 000-004 and all Brenden character files
--subjects "chapters:000..004,characters:brenden"

# Get all characters and all places
--subjects "characters:*,places:*"

# Get everything
--subjects "*"

# Get specific character states
--subjects "characters:brenden/farmboy,mireth/60s,lowfield_joss/main"
```

## Flat Output Mode

Use the `--flat` flag to flatten the output structure in the directory:

```bash
# Normal structure: chapters/chapter-001.md, characters/brenden/farmboy.md
python3 tools/bundle/bundle.py --story eol-saga --book book1 --subjects "chapters:001,characters:brenden"

# Flat structure with path prefixes: chapters_chapter-001.md, characters_brenden_brenden_as_farmboy.md
python3 tools/bundle/bundle.py --story eol-saga --book book1 --subjects "chapters:001,characters:brenden" --flat
```

### Flat Mode Naming Convention

When using `--flat`, files are prefixed with their full directory path:

- `chapters/chapter-001.md` → `chapters_chapter-001.md`
- `characters/brenden/brenden_as_farmboy.md` → `characters_brenden_brenden_as_farmboy.md`
- `characters/maela/maela_as_mother.md` → `characters_maela_maela_as_mother.md`
- `guidelines/writing.md` → `guidelines_writing.md`
- `lore/saga_and_lore.md` → `lore_saga_and_lore.md`

## Available Subjects

Bundles can include various types of story content:

### Characters
- **Structure**: `characters/<character>/<state>.md`
- **Examples**: `characters/brenden/farmboy.md`, `characters/mireth/60s.md`, `characters/lowfield_joss/main.md`
- **Patterns**: `"brenden"`, `"brenden/farmboy"`, `"*/farmboy"`, `"*/*"`, `"lowfield_*"`, `"main"`

### Chapters
- **Structure**: `chapters/chapter-<number>.md`
- **Examples**: `chapters/chapter-001.md`, `chapters/chapter-002.md`
- **Patterns**: `"000..004"`, `"001,003,005"`, `"*"`

### Guidelines
- **Structure**: `guidelines/<topic>.md`
- **Examples**: `guidelines/writing.md`, `guidelines/voice.md`
- **Patterns**: `"writing"`, `"*"`

### Artifacts
- **Structure**: `artifacts/<item>.md`
- **Examples**: `artifacts/twin_blades.md`, `artifacts/ring.md`
- **Patterns**: `"twin_blades"`, `"*"`

### Places
- **Structure**: `places/<location>.md`
- **Examples**: `places/brannock_vale.md`, `places/circle_tower.md`
- **Patterns**: `"brannock_vale"`, `"*"`

## Bundle Contents

Each bundle contains:
- Selected story content organized by subject structure (unless `--flat` is used)
- Manifest file (manifest.json) listing all included files
- Files organized with subject/item structure in the directory (or flattened if `--flat`)
- Easy access to individual files for editing and processing
